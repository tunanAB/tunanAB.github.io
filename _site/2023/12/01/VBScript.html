<h3 id="输入输出">输入输出</h3>

<h3 id="变量">变量</h3>

<ul>
  <li>
    <p>必须以字母开头</p>
  </li>
  <li>
    <p>不能包含点号（.）</p>
  </li>
  <li>
    <p>不能超过 255 个字符</p>
  </li>
</ul>

<p>在 VBScript 中，所有的变量都与类型 <em>variant</em> 相关，可存储不同类型的数据。</p>

<pre><code class="language-vbscript">Dim x
Dim carname
' 两种方式都可以创建变量
carname="Volvo"
</code></pre>

<p>现在您又创建了一个变量。变量的名称是 “carname”。然后，这个做法不是一个好习惯，因为您可能会在脚本中<strong>拼错变量名</strong>，那样可能会在脚本运行时引起奇怪的结果。</p>

<p>如果您拼错变量名，比如 “carname” 变量错拼为 “carnime”，脚本会自动创建一个名为 “carnime” 的新变量。为了防止脚本这样做，您可以使用 Option Explicit 语句。如果您使用这个语句，就必须使用 dim、public 或 private 语句来声明所有的变量。</p>

<pre><code class="language-vbscript">Option Explicit
Dim carname
carname=some value
</code></pre>

<h5 id="为变量赋值">为变量赋值</h5>

<pre><code class="language-vbscript">carname="Volvo"
x=10
</code></pre>

<p>变量名是在表达式的左侧，需要赋给变量的值在表达式的右侧。现在变量 “carname” 的值是 “Volvo”，变量 “x” 的值是 “10”。</p>

<h5 id="变量的生存期">变量的生存期</h5>

<p>变量的生存期指的是它可以存在的时长。</p>

<p>当您在一个子程序中声明变量时，变量只能在此程序内进行访问。当退出此程序时，变量也会失效。这样的变量称为本地变量。您可以在不同的子程序中使用名称相同的本地变量，因为每个变量只能在声明它的程序内得到识别。</p>

<p>如果您在子程序以外声明了一个变量，在您的页面上的所有子程序都可以访问它。这类变量的生存期始于它们被声明，止于页面被关闭。</p>

<h4 id="vbscript-数组变量">VBScript 数组变量</h4>

<h5 id="定义">定义</h5>

<pre><code class="language-vbscript">Dim names(2)
' 注意，这里定义的数组是包含三个元素
names(0)="Tove"
names(1)="Jani"
names(2)="Stale"
</code></pre>

<h5 id="多维数组">多维数组</h5>

<pre><code class="language-vbscript">Dim table(4,6)
</code></pre>

<h3 id="条件语句">条件语句</h3>

<p>在 VBScript 中，我们可以使用四种条件语句：</p>

<ul>
  <li><strong>If 语句</strong> - 假如您希望在条件为 true 时执行一系列的代码，可以使用这个语句</li>
  <li><strong>If…Then…Else 语句</strong> - 假如您希望执行两套代码其中之一，可以使用这个语句</li>
  <li><strong>If…Then…ElseIf 语句</strong> - 假如您希望选择多套代码之一来执行，可以使用这个语句</li>
  <li><strong>Select Case 语句</strong> - 假如您希望选择多套代码之一来执行，可以使用这个语句</li>
</ul>

<h5 id="ifthenelse">If…Then…Else</h5>

<p>在下面的情况中，您可以使用 If…Then…Else 语句：</p>

<ul>
  <li>在条件为 true 时，执行某段代码</li>
  <li>选择两段代码之一来执行</li>
</ul>

<p>在条件为 true 时只执行<strong>一条</strong>语句，可以把代码写为一行：</p>

<pre><code class="language-vbscript">If i=10 Then alert("Hello")
</code></pre>

<p>在上面的代码中，没有 ..Else.. 语句。我们仅仅让代码在条件为 true 时（当 i=10 时）执行<strong>一项操作</strong>。</p>

<p>如果在条件为 true 时执行<strong>不止一条</strong>语句，那么就必须在一行写一条语句，然后使用关键词 “End If” 来结束这个语句：</p>

<pre><code class="language-vbscript">If i=10 Then
alert("Hello")
i = i+1
End If
</code></pre>

<p>在上面的代码中，同样没有 ..Else.. 语句。我们仅仅让代码在条件为 true 时执行了<strong>多项操作</strong>。</p>

<p>假如您想要在条件为 true 时执行某条语句，并在条件不为 true 时执行另一条语句，就必须添加关键词 “Else”：</p>

<pre><code class="language-vbscript">i=hour(time)
If i &lt; 10 Then
document.write("Good morning!")
Else
document.write("Have a nice day!")
End If
</code></pre>

<h5 id="ifthenelseif">If…Then…ElseIf</h5>

<pre><code class="language-vbscript">i=hour(time)
If i = 10 Then
document.write("Just started...!")
ElseIf i = 11 Then
document.write("Hungry!")
ElseIf i = 12 Then
document.write("Ah, lunch-time!")
ElseIf i = 16 Then
document.write("Time to go home!")
Else
document.write("Unknown")
End If
</code></pre>

<h5 id="select-case">Select Case</h5>

<pre><code class="language-vbscript">d=weekday(date)
Select Case d
Case 1
document.write("Sleepy Sunday")
Case 2
document.write("Monday again!")
Case 3
document.write("Just Tuesday!")
Case 4
document.write("Wednesday!")
Case 5
document.write("Thursday...")
Case 6
document.write("Finally Friday!")
Case else
document.write("Super Saturday!!!!")
End Select
</code></pre>

<h3 id="循环">循环</h3>

<p>循环语句用于运行相同的代码块指定的次数。Looping statements are used to run the same block of code a specified number of times.</p>

<p>在 VBScript 中，我们可以使用四种循环语句：</p>

<ul>
  <li><strong>For…Next 语句</strong> - 运行一段代码指定的次数</li>
  <li><strong>For Each…Next 语句</strong> - 针对集合中的每个项目或者数组中的每个元素来运行某段代码</li>
  <li><strong>Do…Loop 语句</strong> - 运行循环，当条件为 true 或者直到条件为 true 时</li>
  <li><strong>While…Wend 语句</strong> - 不要使用这个语句 - 请使用 Do…Loop 语句代替它</li>
</ul>

<h5 id="fornext">For…Next</h5>

<p>请使用 <strong>For…Next</strong> 语句运行一段代码指定的次数。</p>

<p><strong>For</strong> 语句规定计数变量（<strong>i</strong>）以及它的初始值和结束值。<strong>Next</strong> 语句会以 1 作为步进值来递增变量（<strong>i</strong>）。</p>

<pre><code class="language-vbscript">For i = 0 To 5
document.write("The number is " &amp; i &amp; "&lt;br /&gt;")
Next
</code></pre>

<h5 id="step-关键词">Step 关键词</h5>

<p>通过 <strong>Step</strong> 关键词，您可以规定计数变量递增或递减的步进值。</p>

<p>在下面的实例中，计数变量（<strong>i</strong>）每次循环的递增步进值为 2。</p>

<pre><code class="language-vbscript">For i=2 To 10 Step 2
some code
Next
</code></pre>

<p>如果要递减计数变量，您就必须使用负的 <strong>Step</strong> 值。并且必须规定小于开始值的结束值。</p>

<p>在下面的实例中，计数变量（<strong>i</strong>）每次循环的递减步进值为 2。</p>

<pre><code class="language-vbscript">For i=10 To 2 Step -2
some code
Next
</code></pre>

<h5 id="退出-fornext">退出 For…Next</h5>

<p>您可以通过 Exit For 关键词退出 For…Next 语句。</p>

<pre><code class="language-vbscript">For i=1 To 10
If i=5 Then Exit For
some code
Next
</code></pre>

<h5 id="for-eachnext">For Each…Next</h5>

<pre><code class="language-vbscript">Dim cars(2)
cars(0)="Volvo"
cars(1)="Saab"
cars(2)="BMW"

For Each x In cars
document.write(x &amp; "&lt;br /&gt;")
Next
</code></pre>

<h4 id="doloop">Do…Loop</h4>

<p>如果你不知道重复多少次，可以使用 Do…Loop 语句。</p>

<p>Do…Loop 语句重复执行某段代码直到条件是 true 或条件变成 true。</p>

<h5 id="重复执行代码直到条件是-true">重复执行代码直到条件是 true</h5>

<p>您可以使用 While 关键字来检查 Do… Loop 语句的条件。</p>

<pre><code class="language-vbscript">Do While i&gt;10
some code
Loop
</code></pre>

<p>如果 <strong>i</strong> 等于 9，上述循环内的代码将终止执行。</p>

<pre><code class="language-vbscript">Do
some code
Loop While i&gt;10
</code></pre>

<p>这个循环内的代码将被执行至少一次，即使 <strong>i</strong> 小于 10。</p>

<h5 id="重复执行代码直到条件变成-true">重复执行代码直到条件变成 true</h5>

<p>您可以使用 Until 关键字来检查 Do…Loop 语句的条件。</p>

<pre><code class="language-vbscript">Do Until i=10
some code
Loop
</code></pre>

<p>如果 <strong>i</strong> 等于 10，上述循环内的代码将终止执行。</p>

<pre><code class="language-vbscript">Do
some code
Loop Until i=10
</code></pre>

<p>这个循环内的代码将被执行至少一次，即使 <strong>i</strong> 等于 10。</p>

<h5 id="退出-doloop">退出 Do…Loop</h5>

<p>您可以通过 Exit Do 关键词退出 Do…Loop 语句。</p>

<pre><code class="language-vbscript">Do Until i=10
i=i-1
If i&lt;10 Then Exit Do
Loop
</code></pre>

<p>这个循环内的代码，只要 <strong>i</strong> 不为 10 且 <strong>i</strong> 大于 10 时都将被执行。</p>
